{"paragraphs":[{"text":"import org.apache.spark.sql.SparkSession\r\n\r\nval warehouseLocation = \"hdfs://192.168.0.50:8020/spark-warehouse\"\r\n\r\nval spark = SparkSession\r\n  .builder()\r\n  .appName(\"Yelp academic dataset example\")\r\n  .config(\"spark.cassandra.connection.host\", \"192.168.0.50\")\r\n  .config(\"spark.sql.warehouse.dir\", warehouseLocation)\r\n  .getOrCreate()\r\n\r\nspark.sparkContext.setLogLevel(\"ERROR\")\r\n\r\nval inputDF = spark.read.json(\"hdfs://192.168.0.50:8020/yelp-dataset/yelp_academic_dataset_review.json\")\r\n\r\ninputDF.createOrReplaceTempView(\"reviews\")\r\n","dateUpdated":"2016-10-30T08:51:41+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1477817008360_1750208943","id":"20161028-175119_347718566","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.SparkSession\n\nwarehouseLocation: String = hdfs://192.168.0.50:8020/spark-warehouse\n\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@776cae27\n\ninputDF: org.apache.spark.sql.DataFrame = [business_id: string, date: string ... 6 more fields]\n"},"dateCreated":"2016-10-30T08:43:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:228","dateFinished":"2016-10-30T08:44:42+0000","dateStarted":"2016-10-30T08:43:34+0000","title":"Load reviews JSON and register as temp view"},{"text":"%sql\nselect stars,count(*) from reviews group by stars","dateUpdated":"2016-10-30T08:51:19+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"stars","index":0,"aggr":"sum"}],"values":[{"name":"count(1)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"stars","index":0,"aggr":"sum"},"yAxis":{"name":"count(1)","index":1,"aggr":"sum"}},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1477817008363_1750593692","id":"20161028-175826_1751381830","result":{"code":"SUCCESS","type":"TABLE","msg":"stars\tcount(1)\n5\t1132610\n1\t331786\n3\t321700\n2\t224334\n4\t674636\n","comment":"","msgTable":[[{"key":"count(1)","value":5},{"key":"count(1)","value":1132610}],[{"value":1},{"value":331786}],[{"value":3},{"value":321700}],[{"value":2},{"value":224334}],[{"value":4},{"value":674636}]],"columnNames":[{"name":"stars","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[[5,1132610],[1,331786],[3,321700],[2,224334],[4,674636]]},"dateCreated":"2016-10-30T08:43:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:229","dateFinished":"2016-10-30T08:45:20+0000","dateStarted":"2016-10-30T08:44:45+0000","title":"Group reviews by stars","focus":true},{"text":"%sql\nselect user_id,count(*) as count from reviews group by user_id order by count desc limit 5","dateUpdated":"2016-10-30T08:51:07+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"user_id","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"user_id","index":0,"aggr":"sum"}},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1477817008364_1748669948","id":"20161028-180114_932099711","dateCreated":"2016-10-30T08:43:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:230","dateFinished":"2016-10-30T08:50:15+0000","dateStarted":"2016-10-30T08:49:35+0000","title":"Printing the top 5 reviewers","result":{"code":"SUCCESS","type":"TABLE","msg":"user_id\tcount\n9A2-wSoBUxlMd3LwmlGrrQ\t1563\nIu3Jo9ROp2IWC9FwtWOaUQ\t1469\nkGgAARL2UmvCcTRfiscjug\t1468\nuZbTb-u-GVjTa2gtQfry5g\t1144\nglRXVWWD6x1EZKfjJawTOg\t1126\nia1nTRAQEaFWv0cwADeK7g\t1126\n3gIfcQq5KxAegwCPXc83cQ\t1083\n5lq4LkrviYgQ4LJNsBYHcA\t1037\nfczQCSmaWF78toLEmb0Zsw\t1013\nPV5voYSD43Cn_3gHmxG7DA\t936\n","comment":"","msgTable":[[{"key":"count","value":"9A2-wSoBUxlMd3LwmlGrrQ"},{"key":"count","value":1563}],[{"value":"Iu3Jo9ROp2IWC9FwtWOaUQ"},{"value":1469}],[{"value":"kGgAARL2UmvCcTRfiscjug"},{"value":1468}],[{"value":"uZbTb-u-GVjTa2gtQfry5g"},{"value":1144}],[{"value":"glRXVWWD6x1EZKfjJawTOg"},{"value":1126}],[{"value":"ia1nTRAQEaFWv0cwADeK7g"},{"value":1126}],[{"value":"3gIfcQq5KxAegwCPXc83cQ"},{"value":1083}],[{"value":"5lq4LkrviYgQ4LJNsBYHcA"},{"value":1037}],[{"value":"fczQCSmaWF78toLEmb0Zsw"},{"value":1013}],[{"value":"PV5voYSD43Cn_3gHmxG7DA"},{"value":936}]],"columnNames":[{"name":"user_id","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["9A2-wSoBUxlMd3LwmlGrrQ",1563],["Iu3Jo9ROp2IWC9FwtWOaUQ",1469],["kGgAARL2UmvCcTRfiscjug",1468],["uZbTb-u-GVjTa2gtQfry5g",1144],["glRXVWWD6x1EZKfjJawTOg",1126],["ia1nTRAQEaFWv0cwADeK7g",1126],["3gIfcQq5KxAegwCPXc83cQ",1083],["5lq4LkrviYgQ4LJNsBYHcA",1037],["fczQCSmaWF78toLEmb0Zsw",1013],["PV5voYSD43Cn_3gHmxG7DA",936]]},"focus":true},{"text":"%sql\n","dateUpdated":"2016-10-30T08:46:19+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1477817179155_-1265655439","id":"20161030-084619_614283228","dateCreated":"2016-10-30T08:46:19+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:535"}],"name":"YelpReviewDataset","id":"2BYCZRW59","angularObjects":{"2BZ3RZUGW:shared_process":[],"2C19BQD4Q:shared_process":[],"2BYP4N8TC:shared_process":[],"2C2RE19VB:shared_process":[],"2C11NAH91:shared_process":[],"2C1M8AHPN:shared_process":[],"2C2SR5JWR:shared_process":[],"2C1GQQSK8:shared_process":[],"2C1Z83XST:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}